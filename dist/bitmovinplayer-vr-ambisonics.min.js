!function t(e,i,n){function s(a,r){if(!i[a]){if(!e[a]){var h="function"==typeof require&&require;if(!r&&h)return h(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var _=i[a]={exports:{}};e[a][0].call(_.exports,function(t){var i=e[a][1][t];return s(i||t)},_,_.exports,t,e,i,n)}return i[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)s(n[a]);return s}({1:[function(t,e,i){!function(t,n){if("object"==typeof i&&"object"==typeof e)e.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var s=n();for(var o in s)("object"==typeof i?i:t)[o]=s[o]}}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";e.Omnitone=i(1)},function(t,e,i){"use strict";var n={},s=i(2),o=i(4),a=i(5),r=i(6),h=i(7),c=i(8),_=i(9),l=i(12);n.loadAudioBuffers=function(t,e){return new Promise(function(i,n){new s(t,e,function(t){i(t)},n)})},n.createFOAConvolver=function(t,e){return new o(t,e)},n.createFOARouter=function(t,e){return new a(t,e)},n.createFOARotator=function(t){return new r(t)},n.createFOAPhaseMatchedFilter=function(t){return new h(t)},n.createFOAVirtualSpeaker=function(t,e){return new c(t,e)},n.createFOADecoder=function(t,e,i){return new _(t,e,i)},n.createFOARenderer=function(t,e){return new l(t,e)},t.exports=n},function(t,e,i){"use strict";function n(t,e,i,n,o){this._context=t,this._buffers=new Map,this._loadingTasks={},this._resolve=i,this._reject=n,this._progress=o;for(var a=0;a<e.length;a++){var r=e[a];if(this._loadingTasks.hasOwnProperty(r.name))return void s.log("Duplicated filename when loading: "+r.name);this._loadingTasks[r.name]=0,this._loadAudioFile(r)}}var s=i(3);n.prototype._loadAudioFile=function(t){var e=new XMLHttpRequest;e.open("GET",t.url),e.responseType="arraybuffer";var i=this;e.onload=function(){200===e.status?i._context.decodeAudioData(e.response,function(e){i._done(t.name,e)},function(e){s.log("Decoding failure: "+t.url+" ("+e+")"),i._done(t.name,null)}):(s.log("XHR Error: "+t.url+" ("+e.statusText+")"),i._done(t.name,null))},e.onerror=function(e){s.log("XHR Network failure: "+t.url),i._done(t.name,null)},e.send()},n.prototype._done=function(t,e){this._loadingTasks[t]=null!==e?"loaded":"failed",this._buffers.set(t,e),this._updateProgress(t)},n.prototype._updateProgress=function(t){var e=0,i=0,n=0;for(var s in this._loadingTasks)n++,"loaded"===this._loadingTasks[s]?e++:"failed"===this._loadingTasks[s]&&i++;return"function"==typeof this._progress?void this._progress(t,e,n):e===n?void this._resolve(this._buffers):e+i===n?void this._reject(this._buffers):void 0},t.exports=n},function(t,e){"use strict";e.log=function(){window.console.log.apply(window.console,["%c[Omnitone]%c "+Array.prototype.slice.call(arguments).join(" ")+" %c(@"+performance.now().toFixed(2)+"ms)","background: #BBDEFB; color: #FF5722; font-weight: 700","font-weight: 400","color: #AAA"])},e.invertMatrix4=function(t,e){var i=e[0],n=e[1],s=e[2],o=e[3],a=e[4],r=e[5],h=e[6],c=e[7],_=e[8],l=e[9],u=e[10],p=e[11],d=e[12],f=e[13],g=e[14],m=e[15],v=i*r-n*a,x=i*h-s*a,R=i*c-o*a,M=n*h-s*r,y=n*c-o*r,A=s*c-o*h,b=_*f-l*d,E=_*g-u*d,C=_*m-p*d,w=l*g-u*f,F=l*m-p*f,H=u*m-p*g,I=v*H-x*F+R*w+M*C-y*E+A*b;return I?(I=1/I,t[0]=(r*H-h*F+c*w)*I,t[1]=(s*F-n*H-o*w)*I,t[2]=(f*A-g*y+m*M)*I,t[3]=(u*y-l*A-p*M)*I,t[4]=(h*C-a*H-c*E)*I,t[5]=(i*H-s*C+o*E)*I,t[6]=(g*R-d*A-m*x)*I,t[7]=(_*A-u*R+p*x)*I,t[8]=(a*F-r*C+c*b)*I,t[9]=(n*C-i*F-o*b)*I,t[10]=(d*y-f*R+m*v)*I,t[11]=(l*R-_*y-p*v)*I,t[12]=(r*E-a*w-h*b)*I,t[13]=(i*w-n*E+s*b)*I,t[14]=(f*x-d*M-g*v)*I,t[15]=(_*M-l*x+u*v)*I,t):null}},function(t,e){"use strict";function i(t,e){if(4!==e.IR.numberOfChannels)throw"IR does not have 4 channels. cannot proceed.";this._active=!1,this._context=t,this._input=this._context.createChannelSplitter(4),this._mergerWY=this._context.createChannelMerger(2),this._mergerZX=this._context.createChannelMerger(2),this._convolverWY=this._context.createConvolver(),this._convolverZX=this._context.createConvolver(),this._splitterWY=this._context.createChannelSplitter(2),this._splitterZX=this._context.createChannelSplitter(2),this._inverter=this._context.createGain(),this._mergerBinaural=this._context.createChannelMerger(2),this._summingBus=this._context.createGain(),this._input.connect(this._mergerWY,0,0),this._input.connect(this._mergerWY,1,1),this._input.connect(this._mergerZX,2,0),this._input.connect(this._mergerZX,3,1),this._mergerWY.connect(this._convolverWY),this._mergerZX.connect(this._convolverZX),this._convolverWY.connect(this._splitterWY),this._convolverZX.connect(this._splitterZX),this._splitterWY.connect(this._mergerBinaural,0,0),this._splitterWY.connect(this._mergerBinaural,0,1),this._splitterWY.connect(this._mergerBinaural,1,0),this._splitterWY.connect(this._inverter,1,0),this._inverter.connect(this._mergerBinaural,0,1),this._splitterZX.connect(this._mergerBinaural,0,0),this._splitterZX.connect(this._mergerBinaural,0,1),this._splitterZX.connect(this._mergerBinaural,1,0),this._splitterZX.connect(this._mergerBinaural,1,1),this._convolverWY.normalize=!1,this._convolverZX.normalize=!1,this._setHRIRBuffers(e.IR),this._inverter.gain.value=-1,this.input=this._input,this.output=this._summingBus,this.enable()}i.prototype._setHRIRBuffers=function(t){this._hrirWY=this._context.createBuffer(2,t.length,t.sampleRate),this._hrirZX=this._context.createBuffer(2,t.length,t.sampleRate),this._hrirWY.getChannelData(0).set(t.getChannelData(0)),this._hrirWY.getChannelData(1).set(t.getChannelData(1)),this._hrirZX.getChannelData(0).set(t.getChannelData(2)),this._hrirZX.getChannelData(1).set(t.getChannelData(3)),this._convolverWY.buffer=this._hrirWY,this._convolverZX.buffer=this._hrirZX},i.prototype.enable=function(){this._mergerBinaural.connect(this._summingBus),this._active=!0},i.prototype.disable=function(){this._mergerBinaural.disconnect(),this._active=!1},t.exports=i},function(t,e){"use strict";function i(t,e){this._context=t,this._splitter=this._context.createChannelSplitter(4),this._merger=this._context.createChannelMerger(4),this._channelMap=e||n.DEFAULT,this._splitter.connect(this._merger,0,this._channelMap[0]),this._splitter.connect(this._merger,1,this._channelMap[1]),this._splitter.connect(this._merger,2,this._channelMap[2]),this._splitter.connect(this._merger,3,this._channelMap[3]),this.input=this._splitter,this.output=this._merger}var n={DEFAULT:[0,1,2,3],APPLE:[2,0,1,3],FUMA:[0,3,1,2]};i.prototype.setChannelMap=function(t){t&&(this._channelMap=t,this._splitter.disconnect(),this._splitter.connect(this._merger,0,this._channelMap[0]),this._splitter.connect(this._merger,1,this._channelMap[1]),this._splitter.connect(this._merger,2,this._channelMap[2]),this._splitter.connect(this._merger,3,this._channelMap[3]))},i.CHANNEL_MAP=n,t.exports=i},function(t,e){"use strict";function i(t){this._context=t,this._splitter=this._context.createChannelSplitter(4),this._inY=this._context.createGain(),this._inZ=this._context.createGain(),this._inX=this._context.createGain(),this._m0=this._context.createGain(),this._m1=this._context.createGain(),this._m2=this._context.createGain(),this._m3=this._context.createGain(),this._m4=this._context.createGain(),this._m5=this._context.createGain(),this._m6=this._context.createGain(),this._m7=this._context.createGain(),this._m8=this._context.createGain(),this._outY=this._context.createGain(),this._outZ=this._context.createGain(),this._outX=this._context.createGain(),this._merger=this._context.createChannelMerger(4),this._splitter.connect(this._inY,1),this._splitter.connect(this._inZ,2),this._splitter.connect(this._inX,3),this._inY.gain.value=-1,this._inX.gain.value=-1,this._inY.connect(this._m0),this._inY.connect(this._m1),this._inY.connect(this._m2),this._inZ.connect(this._m3),this._inZ.connect(this._m4),this._inZ.connect(this._m5),this._inX.connect(this._m6),this._inX.connect(this._m7),this._inX.connect(this._m8),this._m0.connect(this._outY),this._m1.connect(this._outZ),this._m2.connect(this._outX),this._m3.connect(this._outY),this._m4.connect(this._outZ),this._m5.connect(this._outX),this._m6.connect(this._outY),this._m7.connect(this._outZ),this._m8.connect(this._outX),this._splitter.connect(this._merger,0,0),this._outY.connect(this._merger,0,1),this._outZ.connect(this._merger,0,2),this._outX.connect(this._merger,0,3),this._outY.gain.value=-1,this._outX.gain.value=-1,this.setRotationMatrix(new Float32Array([1,0,0,0,1,0,0,0,1])),this.input=this._splitter,this.output=this._merger}i.prototype.setRotationMatrix=function(t){this._m0.gain.value=t[0],this._m1.gain.value=t[1],this._m2.gain.value=t[2],this._m3.gain.value=t[3],this._m4.gain.value=t[4],this._m5.gain.value=t[5],this._m6.gain.value=t[6],this._m7.gain.value=t[7],this._m8.gain.value=t[8]},i.prototype.setRotationMatrix4=function(t){this._m0.gain.value=t[0],this._m1.gain.value=t[1],this._m2.gain.value=t[2],this._m3.gain.value=t[4],this._m4.gain.value=t[5],this._m5.gain.value=t[6],this._m6.gain.value=t[8],this._m7.gain.value=t[9],this._m8.gain.value=t[10]},i.prototype.getRotationMatrix=function(){return[this._m0.gain.value,this._m1.gain.value,this._m2.gain.value,this._m3.gain.value,this._m4.gain.value,this._m5.gain.value,this._m6.gain.value,this._m7.gain.value,this._m8.gain.value]},t.exports=i},function(t,e,i){"use strict";function n(t,e){var i=Math.tan(Math.PI*t/e),n=i*i,s=n+2*i+1;return{lowpassA:[1,2*(n-1)/s,(n-2*i+1)/s],lowpassB:[n/s,2*n/s,n/s],hipassA:[1,2*(n-1)/s,(n-2*i+1)/s],hipassB:[1/s,-2/s,1/s]}}function s(t){if(this._context=t,this._input=this._context.createGain(),this._context.createIIRFilter){var e=n(a,this._context.sampleRate);this._lpf=this._context.createIIRFilter(e.lowpassB,e.lowpassA),this._hpf=this._context.createIIRFilter(e.hipassB,e.hipassA)}else o.log("IIR filter is missing. Using Biquad filter instead."),this._lpf=this._context.createBiquadFilter(),this._hpf=this._context.createBiquadFilter(),this._lpf.frequency.value=a,this._hpf.frequency.value=a,this._hpf.type="highpass";this._splitterLow=this._context.createChannelSplitter(4),this._splitterHigh=this._context.createChannelSplitter(4),this._gainHighW=this._context.createGain(),this._gainHighY=this._context.createGain(),this._gainHighZ=this._context.createGain(),this._gainHighX=this._context.createGain(),this._merger=this._context.createChannelMerger(4),this._input.connect(this._hpf),this._hpf.connect(this._splitterHigh),this._splitterHigh.connect(this._gainHighW,0),this._splitterHigh.connect(this._gainHighY,1),this._splitterHigh.connect(this._gainHighZ,2),this._splitterHigh.connect(this._gainHighX,3),this._gainHighW.connect(this._merger,0,0),this._gainHighY.connect(this._merger,0,1),this._gainHighZ.connect(this._merger,0,2),this._gainHighX.connect(this._merger,0,3),this._input.connect(this._lpf),this._lpf.connect(this._splitterLow),this._splitterLow.connect(this._merger,0,0),this._splitterLow.connect(this._merger,1,1),this._splitterLow.connect(this._merger,2,2),this._splitterLow.connect(this._merger,3,3);var i=this._context.currentTime;this._gainHighW.gain.setValueAtTime(-1*r[0],i),this._gainHighY.gain.setValueAtTime(-1*r[1],i),this._gainHighZ.gain.setValueAtTime(-1*r[2],i),this._gainHighX.gain.setValueAtTime(-1*r[3],i),this.input=this._input,this.output=this._merger}var o=i(3),a=690,r=[1.4142,.8166,.8166,.8166];t.exports=s},function(t,e){"use strict";function i(t,e){if(2!==e.IR.numberOfChannels)throw"IR does not have 2 channels. cannot proceed.";this._active=!1,this._context=t,this._input=this._context.createChannelSplitter(4),this._cW=this._context.createGain(),this._cY=this._context.createGain(),this._cZ=this._context.createGain(),this._cX=this._context.createGain(),this._convolver=this._context.createConvolver(),this._gain=this._context.createGain(),this._input.connect(this._cW,0),this._input.connect(this._cY,1),this._input.connect(this._cZ,2),this._input.connect(this._cX,3),this._cW.connect(this._convolver),this._cY.connect(this._convolver),this._cZ.connect(this._convolver),this._cX.connect(this._convolver),this._convolver.connect(this._gain),this._gain.connect(this._context.destination),this.enable(),this._convolver.normalize=!1,this._convolver.buffer=e.IR,this._gain.gain.value=e.gain,this._cW.gain.value=e.coefficients[0],this._cY.gain.value=e.coefficients[1],this._cZ.gain.value=e.coefficients[2],this._cX.gain.value=e.coefficients[3],this.input=this._input}i.prototype.enable=function(){this._gain.connect(this._context.destination),this._active=!0},i.prototype.disable=function(){this._gain.disconnect(),this._active=!1},t.exports=i},function(t,e,i){"use strict";function n(t,e,i){this._isDecoderReady=!1,this._context=t,this._videoElement=e,this._decodingMode="ambisonic",this._postGainDB=p,this._HRTFSetUrl=u,this._channelMap=o.CHANNEL_MAP.DEFAULT,i&&(i.postGainDB&&(this._postGainDB=i.postGainDB),i.HRTFSetUrl&&(this._HRTFSetUrl=i.HRTFSetUrl),i.channelMap&&(this._channelMap=i.channelMap)),this._speakerData=[];for(var n=0;n<c.length;++n)this._speakerData.push({name:c[n].name,url:this._HRTFSetUrl+"/"+c[n].url,coef:c[n].coef});this._tempMatrix4=new Float32Array(16)}var s=i(2),o=i(5),a=i(6),r=i(7),h=i(8),c=i(10),_=i(3),l=i(11),u="https://raw.githubusercontent.com/GoogleChrome/omnitone/master/build/resources/",p=0;n.prototype.initialize=function(){_.log("Version: "+l),_.log("Initializing... (mode: "+this._decodingMode+")");var t=this._channelMap.toString(),e=o.CHANNEL_MAP.DEFAULT.toString();t!==e&&_.log("Remapping channels (["+e+"] -> ["+t+"])"),this._audioElementSource=this._context.createMediaElementSource(this._videoElement),this._foaRouter=new o(this._context,this._channelMap),this._foaRotator=new a(this._context),this._foaPhaseMatchedFilter=new r(this._context),this._audioElementSource.connect(this._foaRouter.input),this._foaRouter.output.connect(this._foaRotator.input),this._foaRotator.output.connect(this._foaPhaseMatchedFilter.input),this._foaVirtualSpeakers=[],this._bypass=this._context.createGain(),this._audioElementSource.connect(this._bypass);var i=Math.pow(10,this._postGainDB/20);_.log("Gain compensation: "+i+" ("+this._postGainDB+"dB)");var n=this;return new Promise(function(t,e){new s(n._context,n._speakerData,function(e){for(var s=0;s<n._speakerData.length;++s)n._foaVirtualSpeakers[s]=new h(n._context,{coefficients:n._speakerData[s].coef,IR:e.get(n._speakerData[s].name),gain:i}),n._foaPhaseMatchedFilter.output.connect(n._foaVirtualSpeakers[s].input);n.setMode(n._decodingMode),n._isDecoderReady=!0,_.log("HRTF IRs are loaded successfully. The decoder is ready."),t()},e)})},n.prototype.setRotationMatrix=function(t){this._foaRotator.setRotationMatrix(t)},n.prototype.setRotationMatrixFromCamera=function(t){_.invertMatrix4(this._tempMatrix4,t.elements),this._foaRotator.setRotationMatrix4(this._tempMatrix4)},n.prototype.setMode=function(t){if(t!==this._decodingMode){switch(t){case"bypass":this._decodingMode="bypass";for(var e=0;e<this._foaVirtualSpeakers.length;++e)this._foaVirtualSpeakers[e].disable();this._bypass.connect(this._context.destination);break;case"ambisonic":this._decodingMode="ambisonic";for(var e=0;e<this._foaVirtualSpeakers.length;++e)this._foaVirtualSpeakers[e].enable();this._bypass.disconnect();break;case"off":this._decodingMode="off";for(var e=0;e<this._foaVirtualSpeakers.length;++e)this._foaVirtualSpeakers[e].disable();this._bypass.disconnect()}_.log("Decoding mode changed. ("+t+")")}},t.exports=n},function(t,e){var i=[{name:"E35_A135",url:"E35_A135.wav",gainFactor:1,coef:[.125,.216495,.21653,-.216495]},{name:"E35_A-135",url:"E35_A-135.wav",gainFactor:1,coef:[.125,-.216495,.21653,-.216495]},{name:"E-35_A135",url:"E-35_A135.wav",gainFactor:1,coef:[.125,.216495,-.21653,-.216495]},{name:"E-35_A-135",url:"E-35_A-135.wav",gainFactor:1,coef:[.125,-.216495,-.21653,-.216495]},{name:"E35_A45",url:"E35_A45.wav",gainFactor:1,coef:[.125,.216495,.21653,.216495]},{name:"E35_A-45",url:"E35_A-45.wav",gainFactor:1,coef:[.125,-.216495,.21653,.216495]},{name:"E-35_A45",url:"E-35_A45.wav",gainFactor:1,coef:[.125,.216495,-.21653,.216495]},{name:"E-35_A-45",url:"E-35_A-45.wav",gainFactor:1,coef:[.125,-.216495,-.21653,.216495]}];t.exports=i},function(t,e){"use strict";t.exports="0.2.2"},function(t,e,i){"use strict";function n(t,e){this._context=t,this._HRIRUrl=_,this._channelMap=o.CHANNEL_MAP.DEFAULT,this._renderingMode="ambisonic",e&&(e.HRIRUrl&&(this._HRIRUrl=e.HRIRUrl),e.renderingMode&&(this._renderingMode=e.renderingMode),e.channelMap&&(this._channelMap=e.channelMap)),this._isRendererReady=!1}var s=i(2),o=i(5),a=i(6),r=i(4),h=i(3),c=i(11),_="resources/sh_hrir_o_1.wav";n.prototype.initialize=function(){return h.log("Version: "+c),h.log("Initializing... (mode: "+this._renderingMode+")"),h.log("Rendering via SH-MaxRE convolution."),this._tempMatrix4=new Float32Array(16),new Promise(this._initializeCallback.bind(this))},n.prototype._initializeCallback=function(t,e){var i="FOA_HRIR_AUDIOBUFFER";new s(this._context,[{name:i,url:this._HRIRUrl}],function(e){this.input=this._context.createGain(),this._bypass=this._context.createGain(),this._foaRouter=new o(this._context,this._channelMap),this._foaRotator=new a(this._context),this._foaConvolver=new r(this._context,{IR:e.get(i)}),this.output=this._context.createGain(),this.input.connect(this._foaRouter.input),this.input.connect(this._bypass),this._foaRouter.output.connect(this._foaRotator.input),this._foaRotator.output.connect(this._foaConvolver.input),this._foaConvolver.output.connect(this.output),this.setChannelMap(this._channelMap),this.setRenderingMode(this._renderingMode),this._isRendererReady=!0,h.log("HRIRs are loaded successfully. The renderer is ready."),t()}.bind(this),function(t){var n="Initialization failed: "+i+" is "+t.get(0)+".";h.log(n),e(n)})},n.prototype.setChannelMap=function(t){this._isRendererReady&&t.toString()!==this._channelMap.toString()&&(h.log("Remapping channels (["+this._channelMap.toString()+"] -> ["+t.toString()+"])."),this._channelMap=t.slice(),this._foaRouter.setChannelMap(this._channelMap))},n.prototype.setRotationMatrix=function(t){this._isRendererReady&&this._foaRotator.setRotationMatrix(t)},n.prototype.setRotationMatrixFromCamera=function(t){this._isRendererReady&&(h.invertMatrix4(this._tempMatrix4,t.elements),this._foaRotator.setRotationMatrix4(this._tempMatrix4))},n.prototype.setRenderingMode=function(t){if(t!==this._renderingMode){switch(t){case"bypass":this._renderingMode="bypass",this._foaConvolver.disable(),this._bypass.connect(this.output);break;case"ambisonic":this._renderingMode="ambisonic",this._foaConvolver.enable(),this._bypass.disconnect();break;case"off":this._renderingMode="off",this._foaConvolver.disable(),this._bypass.disconnect();break;default:return void h.log('Rendering mode "'+t+'" is not supported.')}h.log("Rendering mode changed. ("+t+")")}},t.exports=n}])})},{}],2:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=t("./OmnitoneFOARendererImplementation"),s=function(){function t(e,i){void 0===i&&(i={});var n=this;this.onPlayerReady=function(t){n.initialize()},this.onPlayerAudioChanged=function(e){var i=t.isAmbisonicTrack(e.sourceAudio),s=t.isAmbisonicTrack(e.targetAudio);!i&&s?(console.debug("Activated Ambisonics audio",e.targetAudio),n.enable()):i&&!s&&(console.debug("Deactivated Ambisonics audio",e.targetAudio),n.disable())},this.onPlayerVrViewingDirectionChange=function(e){console.log("VRViewingDirectionChange",e.direction);var i=t.getRotationMatrix(e.direction,n.config);n.implementation.update(i)},this.player=e,this.config=i,this.config.autoSelectAmbisonicAudio=i.autoSelectAmbisonicAudio||!0,this.config.yawOffset=i.yawOffset||0,e.addEventHandler(e.EVENT.ON_READY,this.onPlayerReady),e.addEventHandler(e.EVENT.ON_AUDIO_CHANGED,this.onPlayerAudioChanged),e.isReady()&&this.initialize()}return t.prototype.release=function(){this.disable(),this.player.removeEventHandler(this.player.EVENT.ON_READY,this.onPlayerReady),this.player.removeEventHandler(this.player.EVENT.ON_AUDIO_CHANGED,this.onPlayerAudioChanged),this.implementation.release()},t.prototype.initialize=function(){if(this.audioContext=new AudioContext,this.mediaElement=this.player.getVideoElement(),t.isVrContent(this.player)&&this.config.autoSelectAmbisonicAudio){var e=this.player.getAvailableAudio(),i=t.findFirstAmbisonicTrack(e);console.log(e,i),i&&(this.player.setAudio(i.id),console.debug("Autoselected first Ambisonics audio track",i))}},t.prototype.enable=function(){t.isVrContent(this.player)&&(this.enabled||(this.implementation?this.implementation.enable():(this.implementation=new n.OmnitoneFOARendererImplementation,this.implementation.start(this.audioContext,this.mediaElement).catch(function(t){return console.error(t)})),this.player.addEventHandler(this.player.EVENT.ON_VR_VIEWING_DIRECTION_CHANGE,this.onPlayerVrViewingDirectionChange),this.enabled=!0))},t.prototype.disable=function(){this.enabled&&(this.player.removeEventHandler(this.player.EVENT.ON_VR_VIEWING_DIRECTION_CHANGE,this.onPlayerVrViewingDirectionChange),this.implementation.disable(),this.enabled=!1)},t.isVrContent=function(t){return!!t.getConfig().source&&!!t.getConfig().source.vr},t.isAmbisonicTrack=function(e){var i=e.role;if(i&&i.length>0)for(var n=0,s=i;n<s.length;n++){var o=s[n];if(o.schemeIdUri===t.VR_SCHEME_ID_URI&&o.value===t.VR_SCHEME_VALUE_FOA)return!0}return!1},t.findFirstAmbisonicTrack=function(e){for(var i=0,n=e;i<n.length;i++){var s=n[i];if(t.isAmbisonicTrack(s))return s}return null},t.getRotationMatrix=function(t,e){var i=Math.PI/180,n=t.yaw*i,s=t.pitch*i,o=t.roll*i,a=n+e.yawOffset,r=s,h=o,c=a,_=r,l=h,u=Math.sin(c),p=Math.cos(c),d=Math.sin(_),f=Math.cos(_),g=Math.sin(l),m=Math.cos(l);return[p*f,p*d*g-u*m,p*d*m+u*g,u*f,u*d*g+p*m,u*d*m-p*g,-d,f*g,f*m]},t.VR_SCHEME_ID_URI="https://bitmovin.com/082017/vr",t.VR_SCHEME_VALUE_FOA="ambisonic-fo",t}();i.Ambisonics=s},{"./OmnitoneFOARendererImplementation":3}],3:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=t("omnitone"),s=function(){function t(){}return t.prototype.start=function(t,e){var i=this;return this.audioContext=t,this.audioSource=this.audioContext.createMediaElementSource(e),this.foaRenderer=n.Omnitone.createFOARenderer(this.audioContext,{HRIRUrl:"https://cdn.rawgit.com/GoogleChrome/omnitone/962089ca/build/resources/sh_hrir_o_1.wav",channelMap:[0,3,1,2]}),this.foaRenderer.initialize().then(function(){i.audioSource.connect(i.foaRenderer.input),i.foaRenderer.output.connect(i.audioContext.destination)})},t.prototype.release=function(){return this.disable(),this.audioSource.disconnect(this.foaRenderer.input),this.foaRenderer.output.disconnect(this.audioContext.destination),this.audioSource.connect(this.audioContext.destination),Promise.resolve()},t.prototype.enable=function(){this.foaRenderer.setRenderingMode("ambisonic")},t.prototype.disable=function(){this.foaRenderer.setRenderingMode("bypass")},t.prototype.update=function(t){this.foaRenderer.setRotationMatrix(t)},t}();i.OmnitoneFOARendererImplementation=s},{omnitone:1}],4:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=t("./Ambisonics"),s=window;s.bitmovin=s.bitmovin||{},s.bitmovin.player=s.bitmovin.player||{},s.bitmovin.player.vr=s.bitmovin.player.vr||{},s.bitmovin.player.vr.Ambisonics=n.Ambisonics},{"./Ambisonics":2}]},{},[4]);
//# sourceMappingURL=bitmovinplayer-vr-ambisonics.min.js.map
